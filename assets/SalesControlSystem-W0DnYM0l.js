import{_ as N,u as T,a as B,r as u,c as n,o as F,f as G,b as s,d as r,e as o,g as S,F as y,h as g,t as c,n as V}from"./index-poo9QcDd.js";const j={class:"sales-control-page"},A={class:"grid-table"},H={class:"unit-name"},$={class:"unit-total-price"},z={class:"unit-area"},q={class:"unit-per-price"},J={key:1,class:"unit-card empty"},K={key:0,class:"status-container"},O={key:1,class:"status-container"},P={__name:"SalesControlSystem",setup(Q){T(t=>({"5ae695cc":h.value.length}));const D=B(),v=u(!0),p=u(null),i=u({}),_=u(null),m=u(null),w=u(null),d=n(()=>(i.value.銷控||[]).filter(e=>e.房型!=="店面")),h=n(()=>{if(d.value.length===0)return[];const t=new Set(d.value.map(e=>e.棟別));return Array.from(t).sort()}),k=n(()=>{if(d.value.length===0)return[];const t=new Set(d.value.map(e=>parseInt(e.樓層,10)));return Array.from(t).sort((e,a)=>a-e)}),M=n(()=>{const t={};for(const e of d.value){const a=e.樓層,l=e.棟別,f=e.戶別,x=I.value.get(f)||{},E=L.value.get(f)||{};t[a]||(t[a]={}),t[a][l]={...e,...x,...E}}return t}),C=n(()=>{const t=[];return k.value.forEach(e=>{h.value.forEach(a=>{var l;t.push({key:`${e}-${a}`,data:((l=M.value[e])==null?void 0:l[a])||null})})}),t});function R(t){_.value&&(_.value.scrollLeft=t.target.scrollLeft),m.value&&(m.value.scrollTop=t.target.scrollTop)}const I=n(()=>{const t=i.value.價格||[],e=new Map;for(const a of t)a.戶別&&e.set(a.戶別,a);return e}),L=n(()=>{const t=i.value.面積||[],e=new Map;for(const a of t)a.戶別&&e.set(a.戶別,a);return e}),b=n(()=>{const t=i.value.參數||[],e=new Map;for(const a of t){const l=a.銷控狀態,f=a.色碼;l&&f&&e.set(l,f)}return e});return F(async()=>{const t=D.params.projectName;if(!t){p.value="未指定建案名稱。",v.value=!1;return}try{const e=await G(t);if(e.status==="success")i.value=e.data;else throw new Error(e.message||"無法獲取銷控資料。")}catch(e){p.value=e.message}finally{v.value=!1}}),(t,e)=>(r(),s("div",j,[e[1]||(e[1]=o("div",{class:"header-top-left"},null,-1)),o("div",{ref_key:"headerTopRef",ref:_,class:"header-top-container"},[(r(!0),s(y,null,g(h.value,a=>(r(),s("div",{key:a,class:"header-cell"},c(a),1))),128))],512),o("div",{ref_key:"headerLeftRef",ref:m,class:"header-left-container"},[(r(!0),s(y,null,g(k.value,a=>(r(),s("div",{key:a,class:"header-cell"},c(a)+"F ",1))),128))],512),o("div",{ref_key:"mainGridRef",ref:w,onScroll:R,class:"main-grid-container"},[o("div",A,[(r(!0),s(y,null,g(C.value,a=>(r(),s("div",{key:a.key,class:"data-cell"},[a.data?(r(),s("div",{key:0,class:"unit-card",style:V({backgroundColor:b.value.get(a.data.銷控後台狀態)||"#ffffff"})},[o("span",H,c(a.data.戶別),1),o("span",$,c(a.data.房屋總表價)+"萬",1),o("span",z,c(a.data["房屋面積(坪)"])+"坪",1),o("span",q,c(a.data["房屋單價(表價)"])+"萬/坪",1)],4)):(r(),s("div",J))]))),128))])],544),v.value?(r(),s("div",K,e[0]||(e[0]=[o("p",null,"正在載入銷控資料...",-1)]))):S("",!0),p.value?(r(),s("div",O,[o("p",null,"錯誤: "+c(p.value),1)])):S("",!0)]))}},W=N(P,[["__scopeId","data-v-cc773973"]]);export{W as default};

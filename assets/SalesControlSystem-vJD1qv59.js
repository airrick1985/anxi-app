import{_ as D,u as B,a as $,r as m,c as n,o as x,f as A,b as a,d as l,e as d,g as u,F as p,h as y,t as _}from"./index-8iVubI_s.js";const N={class:"sales-control-page"},R={class:"grid-table"},F={class:"header-cell header-left"},V={key:0,class:"unit-card"},j={class:"unit-name"},E={key:1,class:"unit-card empty"},H={key:3,class:"status-container"},I={key:4,class:"status-container"},M={__name:"SalesControlSystem",setup(G){B(t=>({"0930ccdb":f.value.length}));const C=$(),o=m(!0),r=m(null),h=m({}),v=m(null);function g(t){if(!v.value)return;t==="left"?v.value.scrollBy({left:-300,behavior:"smooth"}):v.value.scrollBy({left:300,behavior:"smooth"})}const S=n(()=>h.value.銷控||[]),c=n(()=>S.value.filter(t=>t.房型!=="店面")),f=n(()=>{if(c.value.length===0)return[];const t=new Set(c.value.map(e=>e.棟別));return Array.from(t).sort()}),w=n(()=>{if(c.value.length===0)return[];const t=new Set(c.value.map(e=>parseInt(e.樓層,10)));return Array.from(t).sort((e,s)=>s-e)}),k=n(()=>{const t={};for(const e of c.value){const s=e.樓層,i=e.棟別;t[s]||(t[s]={}),t[s][i]=e}return t});return n(()=>({"grid-template-columns":`auto repeat(${f.value.length}, 1fr)`})),x(async()=>{const t=C.params.projectName;if(!t){r.value="未指定建案名稱。",o.value=!1;return}try{const e=await A(t);if(e.status==="success")h.value=e.data;else throw new Error(e.message||"無法獲取銷控資料。")}catch(e){r.value=e.message}finally{o.value=!1}}),(t,e)=>(l(),a("div",N,[!o.value&&!r.value?(l(),a("button",{key:0,onClick:e[0]||(e[0]=s=>g("left")),class:"scroll-button left-scroll-button"},"<")):d("",!0),!o.value&&!r.value?(l(),a("button",{key:1,onClick:e[1]||(e[1]=s=>g("right")),class:"scroll-button right-scroll-button"},">")):d("",!0),!o.value&&!r.value?(l(),a("div",{key:2,ref_key:"gridContainerRef",ref:v,class:"grid-container"},[u("div",R,[e[2]||(e[2]=u("div",{class:"header-top-left"},null,-1)),(l(!0),a(p,null,y(f.value,s=>(l(),a("div",{key:s,class:"header-cell header-top"},_(s),1))),128)),(l(!0),a(p,null,y(w.value,s=>(l(),a(p,{key:s},[u("div",F,_(s)+"F ",1),(l(!0),a(p,null,y(f.value,i=>{var b;return l(),a("div",{key:`${s}-${i}`,class:"data-cell"},[(b=k.value[s])!=null&&b[i]?(l(),a("div",V,[u("span",j,_(k.value[s][i].戶別),1)])):(l(),a("div",E))])}),128))],64))),128))])],512)):d("",!0),o.value?(l(),a("div",H,e[3]||(e[3]=[u("p",null,"正在載入銷控資料...",-1)]))):d("",!0),r.value?(l(),a("div",I,[u("p",null,"錯誤: "+_(r.value),1)])):d("",!0)]))}},q=D(M,[["__scopeId","data-v-2b5386a8"]]);export{q as default};
